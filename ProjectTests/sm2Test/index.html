<html>
    <head>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script src="//connect.soundcloud.com/sdk-2.0.0.js"></script>
        <script type="text/javascript" src="soundmanager/script/soundmanager2.js"></script>
        <script type="text/javascript">

            var cid     = '9896695e978359ad6e39e1b98f22abb4';
            var ready   = false;
            var track_url;
            var currentSound;

            SC.initialize({
              client_id: cid
            });

            soundManager.setup({
                flashVersion: 9, // optional: shiny features (default = 8)
                preferFlash: false,
                onready: function() {
                    ready       = true; //I'm assuming soundManager just has a ready property.
                    track_url   = 'https://soundcloud.com/hadouken/hadouken-bliss-out-1';
                }
            });

            function StartSong(){
                soundManager.stop('currentSound');
                soundManager.destroySound("currentSound");

                track_url = document.getElementById("url").value;
                
                SC.get('/resolve', { url: track_url }, function(track) {
                    var art = track.artwork_url;
                    art = art.replace("-large", '-crop');
                    document.getElementById("album_art").src = art;
                    document.getElementById("song_name").innerHTML = track.title;
                    document.getElementById("user_name").innerHTML = track.user.username;

                    currentSound = soundManager.createSound({
                        id: "currentSound", // optional: provide your own unique id
                        url: track.stream_url + '?client_id=' + cid,
                        autoLoad: true,
                        autoPlay: true,
                        multiShot: false,
                        multiShotEvents: false,
                        whileplaying: function() {
                                document.getElementById('song_progress').value = this.position/this.duration;
                        }
                    });

                    document.getElementById("play_button").innerHTML = "Pause";
                });
            }

            function TogglePlay(){
                currentSound.togglePause();
                if(currentSound.paused){
                    document.getElementById("play_button").innerHTML = "Play";
                }
                else{
                    document.getElementById("play_button").innerHTML = "Pause";
                }
            }
        </script>
    </head>

    <body>
        <h1>Soundmanager Test</h1>
        <img id="album_art" src="http://gfm.fm/assets/img/default-albumart.png" alt="Album Art" style="border: 5px solid grey"/>
        <progress id="song_progress" value="0" max="1"></progress>
        <h3 id="song_name">Song</h3>
        <h4 id="user_name">Artist</h4>
        <input type="text" name="url" id="url"/>
        <button onclick="StartSong()">Get Song!</button>
        <button onclick="soundManager.stop('currentSound')">Stop</button>
        <button id="play_button" onclick="TogglePlay()">Play</button>
    </body>
</html>